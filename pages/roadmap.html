<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Roadmap - Roadmap Tech</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* CSS Variables para Temas */
    :root {
      --bg-primary: #0f172a;
      --bg-secondary: #1e293b;
      --bg-tertiary: #334155;
      --text-primary: #ffffff;
      --text-secondary: #e2e8f0;
      --text-muted: #94a3b8;
      --accent-primary: #3b82f6;
      --accent-secondary: #1d4ed8;
      --glass-bg: rgba(255, 255, 255, 0.1);
      --glass-border: rgba(255, 255, 255, 0.2);
      --shadow-light: rgba(0, 0, 0, 0.1);
      --shadow-medium: rgba(0, 0, 0, 0.2);
      --shadow-heavy: rgba(0, 0, 0, 0.3);
    }
    
    [data-theme="light"] {
      --bg-primary: #f8fafc;
      --bg-secondary: #f1f5f9;
      --bg-tertiary: #e2e8f0;
      --text-primary: #0f172a;
      --text-secondary: #334155;
      --text-muted: #64748b;
      --accent-primary: #3b82f6;
      --accent-secondary: #1d4ed8;
      --glass-bg: rgba(255, 255, 255, 0.8);
      --glass-border: rgba(0, 0, 0, 0.1);
      --shadow-light: rgba(0, 0, 0, 0.05);
      --shadow-medium: rgba(0, 0, 0, 0.1);
      --shadow-heavy: rgba(0, 0, 0, 0.15);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      line-height: 1.6;
      color: var(--text-primary);
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 30%, var(--bg-tertiary) 60%, var(--bg-secondary) 85%, var(--bg-primary) 100%);
      min-height: 100vh;
      transition: all 0.3s ease;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .nav {
      background: var(--glass-bg);
      -webkit-backdrop-filter: blur(15px);
      backdrop-filter: blur(15px);
      border-bottom: 1px solid var(--glass-border);
      padding: 1rem 0;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px var(--shadow-light);
    }

    .nav-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: bold;
      font-size: 1.25rem;
      color: var(--text-primary);
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }
    
    /* Theme Toggle Button */
    .theme-toggle {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 50px;
      padding: 0.5rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 44px;
      height: 44px;
      transition: all 0.3s ease;
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
    }
    
    .theme-toggle:hover {
      background: var(--glass-border);
      transform: scale(1.05);
    }
    
    .theme-toggle-icon {
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .nav-links {
      display: flex;
      gap: 2rem;
      align-items: center;
    }

    .nav-link {
      color: var(--text-primary);
      text-decoration: none;
      transition: all 0.3s ease;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-weight: 500;
    }

    .nav-link:hover {
      background: var(--glass-border);
      transform: translateY(-1px);
    }

    main {
      padding-top: 5rem;
      min-height: 100vh;
    }

    .hero {
      text-align: center;
      padding: 3rem 0;
      margin-bottom: 3rem;
    }

    .hero-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .hero h1 {
      font-size: clamp(2rem, 4vw, 3.5rem);
      font-weight: bold;
      margin-bottom: 1rem;
    }

    .hero p {
      font-size: 1.2rem;
      opacity: 0.8;
      max-width: 600px;
      margin: 0 auto 2rem;
    }

    .hero-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s;
      border: none;
      cursor: pointer;
    }

    .btn-primary {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .roadmap-section {
      background: var(--glass-bg);
      -webkit-backdrop-filter: blur(15px);
      backdrop-filter: blur(15px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      padding: 2.5rem;
      margin-bottom: 2rem;
      transition: all 0.3s ease;
      box-shadow: 0 8px 32px var(--shadow-light);
    }
    
    .roadmap-section:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 40px var(--shadow-medium);
    }

    .section-title {
      font-size: 1.8rem;
      font-weight: bold;
      margin-bottom: 1.5rem;
      color: #60a5fa;
    }

    .topic-card {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 1.5rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px var(--shadow-light);
    }
    
    .topic-card:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 30px var(--shadow-medium);
      border-color: var(--accent-primary);
    }

    .topic-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .topic-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }

    .topic-title {
      font-size: 1.3rem;
      font-weight: bold;
    }

    .topic-description {
      margin-bottom: 1rem;
      opacity: 0.8;
      line-height: 1.6;
    }

    .resources-list {
      list-style: none;
      padding: 0;
    }

    .resource-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .resource-item:last-child {
      border-bottom: none;
    }

    .resource-link {
      color: #60a5fa;
      text-decoration: none;
      transition: opacity 0.3s;
    }

    .resource-link:hover {
      opacity: 0.8;
    }

    .progress-section {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      text-align: center;
    }

    .progress-bar {
      width: 100%;
      height: 10px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 5px;
      overflow: hidden;
      margin: 1rem 0;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #60a5fa);
      border-radius: 5px;
      width: 25%;
      transition: width 0.3s;
    }

    .stats {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-top: 1rem;
    }

    .stat {
      text-align: center;
    }

    .stat-number {
      font-size: 1.5rem;
      font-weight: bold;
      color: #60a5fa;
    }

    .stat-label {
      font-size: 0.9rem;
      opacity: 0.7;
    }

    .footer {
      background: rgba(0, 0, 0, 0.3);
      padding: 3rem 0;
      text-align: center;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      margin-top: 4rem;
    }

    .footer-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .footer p {
      opacity: 0.6;
    }

    @media (max-width: 768px) {
      .nav-content {
        flex-direction: column;
        gap: 1rem;
        padding: 1rem 0;
      }

      main {
        padding-top: 7rem;
      }

      .hero-buttons {
        flex-direction: column;
        align-items: center;
      }

      .stats {
        flex-direction: column;
        gap: 1rem;
      }

      .topic-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="nav">
    <div class="container">
      <div class="nav-content">
        <a href="../index.html" class="logo">
          <div class="logo-icon">üöÄ</div>
          Roadmap Tech
        </a>
        
        <div class="nav-links">
          <a href="./roadmaps.html" class="nav-link">‚Üê Voltar aos Roadmaps</a>
          <button class="theme-toggle" id="theme-toggle" title="Alternar tema">
            <span class="theme-toggle-icon">üåô</span>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main>
    <div class="container">
      <!-- Hero Section -->
      <div class="hero">
        <div class="hero-icon" id="roadmap-icon">üìä</div>
        <h1 id="roadmap-title">Data Scientist</h1>
        <p id="roadmap-description">
          Torne-se um cientista de dados completo. Aprenda Python, machine learning, 
          estat√≠stica e como resolver problemas reais com dados.
        </p>
        
        <div class="hero-buttons">
          <button class="btn btn-primary">üéØ Continuar Aprendizado</button>
          <button class="btn btn-secondary">ü§ñ Mentor IA</button>
          <button class="btn btn-secondary">üìù Fazer Quiz</button>
        </div>
      </div>

      <!-- Progress Section -->
      <div class="progress-section">
        <h3>Seu Progresso</h3>
        <div class="progress-bar">
          <div class="progress-fill"></div>
        </div>
        <div class="stats">
          <div class="stat">
            <div class="stat-number">5</div>
            <div class="stat-label">T√≥picos Conclu√≠dos</div>
          </div>
          <div class="stat">
            <div class="stat-number">20</div>
            <div class="stat-label">Total de T√≥picos</div>
          </div>
          <div class="stat">
            <div class="stat-number">30%</div>
            <div class="stat-label">Progresso</div>
          </div>
        </div>
      </div>

      <!-- AI Cards Section -->
      <div class="ai-cards-section" style="margin-bottom: 2rem;">
        <h2 style="color: #ffffff; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
          ü§ñ Assistente IA - Sistema de 5 Perguntas Progressivas
        </h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
          <!-- Card Tarefas IA -->
          <div class="ai-card" data-card-type="ai" data-card="ai-task" style="
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
          ">
            <div style="position: absolute; top: -50%; right: -50%; width: 100%; height: 100%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); pointer-events: none;"></div>
            <div style="position: relative; z-index: 2;">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">üéØ</div>
              <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.1rem;">Tarefas IA</h3>
              <p style="color: rgba(255,255,255,0.9); font-size: 0.9rem; line-height: 1.4;">5 perguntas progressivas com dificuldades graduais</p>
              <div style="display: flex; gap: 0.25rem; margin-top: 0.75rem;">
                <span style="background: rgba(255,255,255,0.2); padding: 0.2rem 0.5rem; border-radius: 12px; font-size: 0.7rem; color: white;">Iniciante</span>
                <span style="background: rgba(255,255,255,0.2); padding: 0.2rem 0.5rem; border-radius: 12px; font-size: 0.7rem; color: white;">Intermedi√°rio</span>
                <span style="background: rgba(255,255,255,0.2); padding: 0.2rem 0.5rem; border-radius: 12px; font-size: 0.7rem; color: white;">Avan√ßado</span>
              </div>
            </div>
          </div>
          
          <!-- Card Mentor IA -->
          <div class="ai-card" data-card-type="ai" data-card="ai-mentor" style="
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
          ">
            <div style="position: absolute; top: -50%; right: -50%; width: 100%; height: 100%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); pointer-events: none;"></div>
            <div style="position: relative; z-index: 2;">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">ü§ñ</div>
              <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.1rem;">Mentor IA</h3>
              <p style="color: rgba(255,255,255,0.9); font-size: 0.9rem; line-height: 1.4;">Consultoria personalizada e orienta√ß√£o para sua carreira</p>
            </div>
          </div>
          
          <!-- Card Quiz IA -->
          <div class="ai-card" data-card-type="ai" data-card="ai-quiz" style="
            background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
          ">
            <div style="position: absolute; top: -50%; right: -50%; width: 100%; height: 100%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); pointer-events: none;"></div>
            <div style="position: relative; z-index: 2;">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">üß†</div>
              <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.1rem;">Quiz IA</h3>
              <p style="color: rgba(255,255,255,0.9); font-size: 0.9rem; line-height: 1.4;">Teste seus conhecimentos com perguntas inteligentes</p>
            </div>
          </div>
          
          <!-- Card An√°lise de Recursos -->
          <div class="ai-card" data-card-type="ai" data-card="ai-analysis" style="
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
          ">
            <div style="position: absolute; top: -50%; right: -50%; width: 100%; height: 100%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); pointer-events: none;"></div>
            <div style="position: relative; z-index: 2;">
              <div style="font-size: 2rem; margin-bottom: 0.5rem;">üîç</div>
              <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.1rem;">Analisar Recursos</h3>
              <p style="color: rgba(255,255,255,0.9); font-size: 0.9rem; line-height: 1.4;">IA analisa e explica recursos de aprendizado</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Roadmap Sections -->
      <div id="roadmap-content" class="roadmap-content">
        <!-- Default Data Scientist Content -->
        <div id="data-scientist-content">
          <div class="roadmap-section">
            <h2 class="section-title">üî¢ Fundamentos de Matem√°tica e Estat√≠stica</h2>
        
        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üìä</div>
            <div class="topic-title">Estat√≠stica Descritiva</div>
          </div>
          <div class="topic-description">
            Aprenda medidas de tend√™ncia central, dispers√£o e como interpretar dados estat√≠sticos b√°sicos.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.coursera.org/learn/statistical-thinking" class="resource-link" target="_blank">Statistical Thinking for Data Science - Coursera</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://www.amazon.com/Think-Stats-Exploratory-Data-Analysis/dp/1491907339" class="resource-link" target="_blank">Think Stats - O'Reilly</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=xxpc-HPKN28" class="resource-link" target="_blank">Statistics Fundamentals - StatQuest</a>
            </li>
          </ul>
        </div>

        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üßÆ</div>
            <div class="topic-title">√Ålgebra Linear</div>
          </div>
          <div class="topic-description">
            Fundamentos de vetores, matrizes e opera√ß√µes essenciais para machine learning.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.khanacademy.org/math/linear-algebra" class="resource-link" target="_blank">Linear Algebra - Khan Academy</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://www.amazon.com/Introduction-Linear-Algebra-Gilbert-Strang/dp/0980232775" class="resource-link" target="_blank">Introduction to Linear Algebra - Gilbert Strang</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="roadmap-section">
        <h2 class="section-title">üêç Python para Data Science</h2>
        
        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üêç</div>
            <div class="topic-title">Python B√°sico</div>
          </div>
          <div class="topic-description">
            Sintaxe Python, estruturas de dados, controle de fluxo e programa√ß√£o orientada a objetos.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.coursera.org/learn/python-data-analysis" class="resource-link" target="_blank">Python for Data Science - Coursera</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://automatetheboringstuff.com/" class="resource-link" target="_blank">Automate the Boring Stuff with Python</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=_uQrJ0TkZlc" class="resource-link" target="_blank">Python Tutorial - Programming with Mosh</a>
            </li>
          </ul>
        </div>

        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üìä</div>
            <div class="topic-title">Pandas e NumPy</div>
          </div>
          <div class="topic-description">
            Manipula√ß√£o e an√°lise de dados com as principais bibliotecas Python.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.kaggle.com/learn/pandas" class="resource-link" target="_blank">Pandas Course - Kaggle</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://www.amazon.com/Python-Data-Analysis-Wrangling-IPython/dp/1491957662" class="resource-link" target="_blank">Python for Data Analysis - Wes McKinney</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="roadmap-section">
        <h2 class="section-title">ü§ñ Machine Learning</h2>
        
        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üß†</div>
            <div class="topic-title">Algoritmos de ML</div>
          </div>
          <div class="topic-description">
            Regress√£o linear, √°rvores de decis√£o, clustering e algoritmos de classifica√ß√£o.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.coursera.org/learn/machine-learning" class="resource-link" target="_blank">Machine Learning - Andrew Ng</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://www.amazon.com/Hands-Machine-Learning-Scikit-Learn-TensorFlow/dp/1492032646" class="resource-link" target="_blank">Hands-On Machine Learning</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=aircAruvnKk" class="resource-link" target="_blank">Neural Networks Explained - 3Blue1Brown</a>
            </li>
          </ul>
        </div>

        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">‚öôÔ∏è</div>
            <div class="topic-title">Scikit-learn e TensorFlow</div>
          </div>
          <div class="topic-description">
            Frameworks essenciais para implementar algoritmos de machine learning em Python.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.kaggle.com/learn/intro-to-machine-learning" class="resource-link" target="_blank">Intro to Machine Learning - Kaggle</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://scikit-learn.org/stable/tutorial/index.html" class="resource-link" target="_blank">Scikit-learn Tutorial</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.tensorflow.org/tutorials" class="resource-link" target="_blank">TensorFlow Tutorials</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="roadmap-section">
        <h2 class="section-title">üìä Visualiza√ß√£o de Dados</h2>
        
        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üìà</div>
            <div class="topic-title">Matplotlib e Seaborn</div>
          </div>
          <div class="topic-description">
            Cria√ß√£o de gr√°ficos estat√≠sticos e visualiza√ß√µes explorat√≥rias em Python.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.kaggle.com/learn/data-visualization" class="resource-link" target="_blank">Data Visualization - Kaggle</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://matplotlib.org/stable/tutorials/index.html" class="resource-link" target="_blank">Matplotlib Tutorials</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=UO98lJQ3QGI" class="resource-link" target="_blank">Seaborn Tutorial - Corey Schafer</a>
            </li>
          </ul>
        </div>

        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üíº</div>
            <div class="topic-title">Tableau e Power BI</div>
          </div>
          <div class="topic-description">
            Ferramentas de visualiza√ß√£o profissional para apresenta√ß√µes e dashboards.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.tableau.com/learn/training" class="resource-link" target="_blank">Tableau Training</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://docs.microsoft.com/en-us/power-bi/" class="resource-link" target="_blank">Power BI Documentation</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=nagfPGj9Bz8" class="resource-link" target="_blank">Power BI Tutorial - ExcelIsFun</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="roadmap-section">
        <h2 class="section-title">üóÑÔ∏è Big Data e Engenharia de Dados</h2>
        
        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üî•</div>
            <div class="topic-title">Apache Spark</div>
          </div>
          <div class="topic-description">
            Processamento de grandes volumes de dados de forma distribu√≠da.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.udacity.com/course/learn-spark-at-udacity--ud2002" class="resource-link" target="_blank">Learn Spark - Udacity</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://spark.apache.org/docs/latest/" class="resource-link" target="_blank">Apache Spark Documentation</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=tDVPcqGpEnM" class="resource-link" target="_blank">Apache Spark Tutorial - Edureka</a>
            </li>
          </ul>
        </div>

        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">‚òÅÔ∏è</div>
            <div class="topic-title">AWS/Azure para Data Science</div>
          </div>
          <div class="topic-description">
            Plataformas cloud para deploy e escalabilidade de modelos de ML.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://aws.amazon.com/training/learn-about/machine-learning/" class="resource-link" target="_blank">AWS ML Training</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://docs.microsoft.com/en-us/azure/machine-learning/" class="resource-link" target="_blank">Azure ML Documentation</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=tDVPcqGpEnM" class="resource-link" target="_blank">AWS SageMaker Tutorial</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="roadmap-section">
        <h2 class="section-title">üéØ Projetos Pr√°ticos</h2>
        
        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üè†</div>
            <div class="topic-title">Predi√ß√£o de Pre√ßos Imobili√°rios</div>
          </div>
          <div class="topic-description">
            Projeto completo de regress√£o com an√°lise explorat√≥ria e deploy de modelo.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques" class="resource-link" target="_blank">House Prices Competition - Kaggle</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://github.com/ageron/handson-ml2" class="resource-link" target="_blank">Hands-On ML Code Examples</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=bly4e2xm_Ok" class="resource-link" target="_blank">End-to-End ML Project - StatQuest</a>
            </li>
          </ul>
        </div>

        <div class="topic-card">
          <div class="topic-header">
            <div class="topic-icon">üõí</div>
            <div class="topic-title">Sistema de Recomenda√ß√£o</div>
          </div>
          <div class="topic-description">
            Construa um sistema de recomenda√ß√£o como Netflix ou Amazon.
          </div>
          <ul class="resources-list">
            <li class="resource-item">
              üìö <a href="https://www.coursera.org/learn/machine-learning-with-python" class="resource-link" target="_blank">ML with Python - IBM</a>
            </li>
            <li class="resource-item">
              üìñ <a href="https://surprise.readthedocs.io/en/stable/" class="resource-link" target="_blank">Surprise Library Documentation</a>
            </li>
            <li class="resource-item">
              üé• <a href="https://www.youtube.com/watch?v=XoTwndOgXBM" class="resource-link" target="_blank">Recommendation Systems - Sentdex</a>
            </li>
          </ul>
        </div>
      </div>
        </div>
        <!-- End Data Scientist Content -->

        <!-- BI Analyst Content -->
        <div id="bi-analyst-content" style="display: none;">
          <div class="roadmap-section">
            <h2 class="section-title">üìä Power BI Avan√ßado</h2>
            
            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">‚ö°</div>
                <div class="topic-title">DAX e Modelagem</div>
              </div>
              <div class="topic-description">
                Domine a linguagem DAX para c√°lculos complexos e construa modelos de dados eficientes.
              </div>
              <ul class="resources-list">
                <li class="resource-item">
                  üìö <a href="https://docs.microsoft.com/en-us/dax/" class="resource-link" target="_blank">DAX Documentation - Microsoft</a>
                </li>
                <li class="resource-item">
                  üìñ <a href="https://www.sqlbi.com/books/the-definitive-guide-to-dax/" class="resource-link" target="_blank">The Definitive Guide to DAX</a>
                </li>
                <li class="resource-item">
                  üé• <a href="https://www.youtube.com/watch?v=klQAZLr5vxA" class="resource-link" target="_blank">DAX Fundamentals - SQLBI</a>
                </li>
              </ul>
            </div>

            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">üìà</div>
                <div class="topic-title">Visualiza√ß√µes Avan√ßadas</div>
              </div>
              <div class="topic-description">
                Crie dashboards interativos e visualiza√ß√µes impactantes para executivos.
              </div>
              <ul class="resources-list">
                <li class="resource-item">
                  üìö <a href="https://learn.microsoft.com/en-us/power-bi/visuals/" class="resource-link" target="_blank">Power BI Visuals - Microsoft Learn</a>
                </li>
                <li class="resource-item">
                  üìñ <a href="https://www.amazon.com/Microsoft-Power-Step-Step/dp/1509307524" class="resource-link" target="_blank">Microsoft Power BI Step by Step</a>
                </li>
                <li class="resource-item">
                  üé• <a href="https://www.youtube.com/c/GuyInACube" class="resource-link" target="_blank">Guy in a Cube - Power BI</a>
                </li>
              </ul>
            </div>
          </div>

          <div class="roadmap-section">
            <h2 class="section-title">üóÉÔ∏è SQL para BI</h2>
            
            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">üîç</div>
                <div class="topic-title">Consultas Complexas</div>
              </div>
              <div class="topic-description">
                Window functions, CTEs, subqueries e otimiza√ß√£o de performance para an√°lises avan√ßadas.
              </div>
              <ul class="resources-list">
                <li class="resource-item">
                  üìö <a href="https://www.w3schools.com/sql/" class="resource-link" target="_blank">SQL Tutorial - W3Schools</a>
                </li>
                <li class="resource-item">
                  üìñ <a href="https://www.amazon.com/Learning-SQL-Generate-Manipulate-Retrieve/dp/1492057614" class="resource-link" target="_blank">Learning SQL - O'Reilly</a>
                </li>
                <li class="resource-item">
                  üé• <a href="https://www.youtube.com/watch?v=HXV3zeQKqGY" class="resource-link" target="_blank">SQL Full Course - FreeCodeCamp</a>
                </li>
              </ul>
            </div>

            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">üèóÔ∏è</div>
                <div class="topic-title">Data Warehouse</div>
              </div>
              <div class="topic-description">
                Conceitos de modelagem dimensional, ETL e arquitetura de data warehouse.
              </div>
              <ul class="resources-list">
                <li class="resource-item">
                  üìö <a href="https://www.kimballgroup.com/data-warehouse-business-intelligence-resources/" class="resource-link" target="_blank">Kimball Group - DW Resources</a>
                </li>
                <li class="resource-item">
                  üìñ <a href="https://www.amazon.com/Data-Warehouse-Toolkit-Definitive-Dimensional/dp/1118530802" class="resource-link" target="_blank">The Data Warehouse Toolkit</a>
                </li>
                <li class="resource-item">
                  üé• <a href="https://www.youtube.com/watch?v=J326LIUrZM8" class="resource-link" target="_blank">Data Warehouse Concepts - Edureka</a>
                </li>
              </ul>
            </div>
          </div>

          <div class="roadmap-section">
            <h2 class="section-title">üìä Excel Avan√ßado</h2>
            
            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">üìã</div>
                <div class="topic-title">Tabelas Din√¢micas e Power Query</div>
              </div>
              <div class="topic-description">
                An√°lise de dados avan√ßada com tabelas din√¢micas e transforma√ß√£o de dados com Power Query.
              </div>
              <ul class="resources-list">
                <li class="resource-item">
                  üìö <a href="https://support.microsoft.com/en-us/office/overview-of-pivottables-and-pivotcharts-527c8fa3-02c0-445a-a2db-7794676bce96" class="resource-link" target="_blank">PivotTables Overview - Microsoft</a>
                </li>
                <li class="resource-item">
                  üìñ <a href="https://www.amazon.com/Power-Query-Excel-Data-Analysis/dp/1615470395" class="resource-link" target="_blank">Power Query for Excel</a>
                </li>
                <li class="resource-item">
                  üé• <a href="https://www.youtube.com/watch?v=UbfzIT6CnIk" class="resource-link" target="_blank">Excel Advanced Tutorial - ExcelIsFun</a>
                </li>
              </ul>
            </div>

            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">ü§ñ</div>
                <div class="topic-title">VBA e Automa√ß√£o</div>
              </div>
              <div class="topic-description">
                Automatize tarefas repetitivas e crie solu√ß√µes personalizadas com VBA.
              </div>
              <ul class="resources-list">
                <li class="resource-item">
                  üìö <a href="https://docs.microsoft.com/en-us/office/vba/excel/concepts/getting-started-with-vba-in-excel" class="resource-link" target="_blank">VBA in Excel - Microsoft</a>
                </li>
                <li class="resource-item">
                  üìñ <a href="https://www.amazon.com/Excel-VBA-Programming-Dummies-2nd/dp/1119518174" class="resource-link" target="_blank">Excel VBA Programming For Dummies</a>
                </li>
                <li class="resource-item">
                  üé• <a href="https://www.youtube.com/watch?v=G05TrN7nt6k" class="resource-link" target="_blank">Excel VBA Tutorial - Wise Owl</a>
                </li>
              </ul>
            </div>
          </div>

          <div class="roadmap-section">
            <h2 class="section-title">üéØ Projetos BI</h2>
            
            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">üìä</div>
                <div class="topic-title">Dashboard Executivo</div>
              </div>
              <div class="topic-description">
                Construa um dashboard executivo completo com KPIs, m√©tricas de neg√≥cio e an√°lise de tend√™ncias.
              </div>
              <ul class="resources-list">
                <li class="resource-item">
                  üìö <a href="https://learn.microsoft.com/en-us/power-bi/create-reports/sample-executive-dashboard" class="resource-link" target="_blank">Executive Dashboard Sample - Microsoft</a>
                </li>
                <li class="resource-item">
                  üìñ <a href="https://www.tableau.com/learn/articles/executive-dashboard" class="resource-link" target="_blank">Executive Dashboard Best Practices</a>
                </li>
                <li class="resource-item">
                  üé• <a href="https://www.youtube.com/watch?v=ggWHJpBnPLA" class="resource-link" target="_blank">Executive Dashboard Tutorial - Power BI</a>
                </li>
              </ul>
            </div>

            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">üí∞</div>
                <div class="topic-title">An√°lise de Vendas</div>
              </div>
              <div class="topic-description">
                An√°lise completa de performance de vendas, forecasting e an√°lise de comportamento do cliente.
              </div>
              <ul class="resources-list">
                <li class="resource-item">
                  üìö <a href="https://www.kaggle.com/datasets/rohitsahoo/sales-forecasting" class="resource-link" target="_blank">Sales Forecasting Dataset - Kaggle</a>
                </li>
                <li class="resource-item">
                  üìñ <a href="https://www.amazon.com/Sales-Analytics-Practical-Guide-Forecasting/dp/1119713882" class="resource-link" target="_blank">Sales Analytics - Practical Guide</a>
                </li>
                <li class="resource-item">
                  üé• <a href="https://www.youtube.com/watch?v=VE0eROGUVF8" class="resource-link" target="_blank">Sales Analysis Power BI - Edureka</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <!-- End BI Analyst Content -->
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="logo-icon">üöÄ</div>
        <span class="logo">Roadmap Tech</span>
      </div>
      <p>Transformando carreiras atrav√©s da educa√ß√£o em tecnologia.</p>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // Global variables - explicitly export to window for global access
    window.geminiAI = null;
    window.currentRoadmap = null;
    window.loadingModal = null;
    
    // Local references for convenience
    // Note: geminiAI will be initialized by the main script
    let currentRoadmap = window.currentRoadmap;
    let loadingModal = window.loadingModal;
    
    // CRITICAL: Implementar fun√ß√µes de loading que estavam faltando
    function showLoadingModal(title, message) {
      // Remove existing loading modal
      if (loadingModal) {
        loadingModal.remove();
      }
      
      loadingModal = document.createElement('div');
      loadingModal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
      `;
      
      loadingModal.innerHTML = `
        <div style="
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
          border-radius: 20px;
          padding: 2rem;
          text-align: center;
          max-width: 400px;
          border: 1px solid rgba(255, 255, 255, 0.2);
        ">
          <div style="
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
          "></div>
          <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">${title}</h3>
          <p style="color: rgba(255, 255, 255, 0.8); margin: 0; font-size: 0.9rem;">${message}</p>
        </div>
      `;
      
      document.body.appendChild(loadingModal);
      
      // Add spin animation if not exists
      if (!document.getElementById('spin-animation')) {
        const style = document.createElement('style');
        style.id = 'spin-animation';
        style.textContent = `
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `;
        document.head.appendChild(style);
      }
    }
    
    function closeLoadingModal() {
      if (loadingModal) {
        loadingModal.remove();
        loadingModal = null;
      }
    }
    
    document.addEventListener('DOMContentLoaded', async function() {
      console.log('üöÄ Iniciando carregamento da p√°gina roadmap...');
      
      // Prevent automatic scroll restoration to avoid flickering
      if ('scrollRestoration' in history) {
        history.scrollRestoration = 'manual';
      }
      
      // Initialize Simple Gemini AI
      try {
        const { getSimpleGeminiAI } = await import('../utils/gemini-ai-simple.js');
        geminiAI = getSimpleGeminiAI();
        console.log('ü§ñ IA Gemini inicializada com sucesso!');
        
        // Setup AI card event listeners
        setupAICardListeners();
      } catch (error) {
        console.warn('‚ö†Ô∏è IA Gemini n√£o dispon√≠vel:', error);
        // Setup basic fallback even without AI
        setupAICardListeners();
      }
      
      // Get roadmap ID from URL parameters
      const params = new URLSearchParams(window.location.search);
      const roadmapId = params.get('id');
      
      // Load expanded roadmap data from roadmaps.js
      let roadmaps = {};
      try {
        const { roadmaps: expandedRoadmaps } = await import('../data/roadmaps.js');
        roadmaps = expandedRoadmaps;
        console.log('‚úÖ Roadmaps expandidos carregados:', Object.keys(roadmaps));
      } catch (error) {
        console.error('‚ùå Erro ao carregar roadmaps expandidos:', error);
        // Fallback to basic data if expanded roadmaps fail to load
        roadmaps = {
          'data-scientist': {
            icon: 'üìä',
            title: 'Data Scientist',
            description: 'Torne-se um cientista de dados completo. Aprenda Python, machine learning, estat√≠stica e como resolver problemas reais com dados.'
          },
          'bi-analyst': {
            icon: 'üìà',
            title: 'BI Analyst',
            description: 'Especialize-se em Business Intelligence. Domine Power BI, SQL, Excel avan√ßado e transforme dados em insights de neg√≥cio.'
          },
          'data-analyst': {
            icon: 'üîç',
            title: 'Data Analyst',
            description: 'Inicie sua carreira em dados. Aprenda SQL, Python b√°sico, visualiza√ß√£o de dados e como extrair insights valiosos.'
          },
          'software-engineer-google': {
            icon: 'üíª',
            title: 'Software Engineer',
            description: 'Prepare-se para Big Tech. Algoritmos, estruturas de dados, design de sistemas e pr√°ticas de desenvolvimento para Google, Meta, etc.'
          }
        };
      }

      // Update page content based on roadmap ID
      if (roadmapId && roadmaps[roadmapId]) {
        currentRoadmap = roadmaps[roadmapId];
        
        // Update header with roadmap info
        document.getElementById('roadmap-icon').textContent = currentRoadmap.icon;
        document.getElementById('roadmap-title').textContent = currentRoadmap.title;
        document.getElementById('roadmap-description').textContent = currentRoadmap.description;
        document.title = `${currentRoadmap.title} - Roadmap Tech`;
        
        // Clear existing content and render expanded roadmap dynamically
        const contentContainer = document.getElementById('roadmap-content');
        contentContainer.innerHTML = '';
        
        // Render expanded roadmap sections
        if (currentRoadmap.sections && currentRoadmap.sections.length > 0) {
          console.log(`üöÄ Renderizando ${currentRoadmap.sections.length} se√ß√µes para ${currentRoadmap.title}`);
          
          currentRoadmap.sections.forEach(section => {
            const sectionElement = createSectionElement(section);
            contentContainer.appendChild(sectionElement);
          });
        } else {
          // Fallback to hardcoded content if no sections available
          const fallbackMessage = document.createElement('div');
          fallbackMessage.className = 'roadmap-section';
          fallbackMessage.innerHTML = `
            <h2 class="section-title">üöß Roadmap em Desenvolvimento</h2>
            <div class="topic-card">
              <div class="topic-header">
                <div class="topic-icon">‚è≥</div>
                <div class="topic-title">Expandindo Conte√∫do</div>
              </div>
              <div class="topic-description">
                Este roadmap est√° sendo expandido com conte√∫do premium. Em breve teremos se√ß√µes detalhadas, recursos curados e projetos pr√°ticos.
              </div>
            </div>
          `;
          contentContainer.appendChild(fallbackMessage);
        }
      } else {
        console.warn('‚ö†Ô∏è Roadmap n√£o encontrado:', roadmapId);
      }
      
      // Show content after everything is loaded
      document.getElementById('content').style.opacity = '1';
      
      // Smooth scroll control after page load
      setTimeout(() => {
        // Ensure page starts at a consistent position
        window.scrollTo({ top: 0, behavior: 'instant' });
        
        // Add smooth scroll behavior for better UX
        document.documentElement.style.scrollBehavior = 'smooth';
      }, 50);
    });
    
    // AI-powered task generation with multiple choice
    window.generateTask = async function(topic) {
      if (!geminiAI) {
        alert('ü§ñ IA n√£o dispon√≠vel no momento. Tente novamente mais tarde.');
        return;
      }
      
      const button = event.target;
      const originalText = button.textContent;
      
      // BUG FIX 1: LOADING IMEDIATO
      showLoadingModal('üéØ Gerando Tarefa IA', `Criando 5 perguntas progressivas sobre ${topic}...`);
      
      try {
        // Show loading state on button too
        button.textContent = '‚è≥ Gerando...';
        button.disabled = true;
        
        // Generate AI task based on current roadmap context
        const difficulty = currentRoadmap?.title?.includes('BI') ? 'intermediate' : 'advanced';
        const task = await geminiAI.generateTask(topic, difficulty);
        
        // Close loading and show interactive task in modal
        closeLoadingModal();
        showProgressiveQuestionsModal(topic, task);
        
      } catch (error) {
        console.error('‚ùå Erro ao gerar tarefa:', error);
        closeLoadingModal();
        alert('ü§ñ N√£o foi poss√≠vel gerar a tarefa. Tente novamente.');
      } finally {
        // Restore button
        button.textContent = originalText;
        button.disabled = false;
      }
    };
    
    // BUG FIXES 2 & 3: IMPLEMENTAR MODAL COMPLETO COM SELE√á√ÉO VISUAL E UNICIDADE
    window.showTaskModal = function(topic, taskData) {
      if (!taskData || !taskData.questions || taskData.questions.length === 0) {
        alert('‚ùå Erro: Dados da tarefa inv√°lidos');
        return;
      }
      
      let currentQuestionIndex = 0;
      let userAnswers = [];
      let score = 0;
      
      // Create modal
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 1rem;
      `;
      
      const modalContent = document.createElement('div');
      modalContent.style.cssText = `
        background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        border-radius: 1rem;
        padding: 2rem;
        max-width: 600px;
        width: 100%;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(148, 163, 184, 0.2);
      `;
      
      modal.appendChild(modalContent);
      
      function renderQuestion() {
        const question = taskData.questions[currentQuestionIndex];
        if (!question) return;
        
        // BUG FIX 3: GARANTIR UNICIDADE DAS OP√á√ïES
        const uniqueOptions = Array.from(new Set(question.options.map(opt => JSON.stringify(opt)))).map(opt => JSON.parse(opt));
        question.options = uniqueOptions;
        
        modalContent.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <h2 style="color: #f1f5f9; margin: 0; font-size: 1.5rem;">üéØ ${topic}</h2>
            <button id="closeTaskModal" style="background: rgba(255, 255, 255, 0.1); color: #fff; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center;">√ó</button>
          </div>
          
          <div style="background: rgba(59, 130, 246, 0.1); border: 1px solid #3b82f6; border-radius: 0.5rem; padding: 1rem; margin-bottom: 2rem;">
            <div style="color: #60a5fa; font-size: 0.9rem; margin-bottom: 0.5rem;">Pergunta ${currentQuestionIndex + 1} de ${taskData.questions.length} ‚Ä¢ Dificuldade: ${question.difficulty || 'Intermedi√°rio'}</div>
            <div style="color: #e2e8f0; font-size: 1.1rem; font-weight: 500;">${question.question}</div>
          </div>
          
          <div id="optionsContainer" style="margin-bottom: 2rem;">
            ${question.options.map((option, index) => `
              <div class="option-item" data-index="${index}" style="
                background: rgba(148, 163, 184, 0.1);
                border: 2px solid transparent;
                border-radius: 0.5rem;
                padding: 1rem;
                margin-bottom: 1rem;
                cursor: pointer;
                transition: all 0.3s ease;
                color: #e2e8f0;
              ">
                <div style="font-weight: 500; margin-bottom: 0.25rem;">${String.fromCharCode(65 + index)}) ${option.text}</div>
                ${option.explanation ? `<div style="font-size: 0.9rem; color: #94a3b8;">${option.explanation}</div>` : ''}
              </div>
            `).join('')}
          </div>
          
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div style="color: #94a3b8; font-size: 0.9rem;">
              Progresso: ${userAnswers.length}/${taskData.questions.length} ‚Ä¢ Pontua√ß√£o: ${score}/${taskData.questions.length}
            </div>
            <div>
              ${currentQuestionIndex > 0 ? '<button id="prevBtn" style="background: rgba(148, 163, 184, 0.2); border: 1px solid #94a3b8; color: #94a3b8; padding: 0.5rem 1rem; border-radius: 0.5rem; margin-right: 1rem; cursor: pointer;">‚Üê Anterior</button>' : ''}
              <button id="nextBtn" style="background: rgba(16, 185, 129, 0.2); border: 1px solid #10b981; color: #10b981; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;" disabled>${currentQuestionIndex === taskData.questions.length - 1 ? 'Finalizar üèÜ' : 'Pr√≥xima ‚Üí'}</button>
            </div>
          </div>
        `;
        
        // BUG FIX 2: SELE√á√ÉO VISUAL DAS ALTERNATIVAS
        const options = modalContent.querySelectorAll('.option-item');
        options.forEach((option, index) => {
          option.addEventListener('click', () => {
            // Remove sele√ß√£o anterior
            options.forEach(opt => {
              opt.style.border = '2px solid transparent';
              opt.style.background = 'rgba(148, 163, 184, 0.1)';
            });
            
            // Aplicar sele√ß√£o visual
            option.style.border = '2px solid #10b981';
            option.style.background = 'rgba(16, 185, 129, 0.2)';
            
            // Habilitar bot√£o pr√≥xima
            const nextBtn = document.getElementById('nextBtn');
            nextBtn.disabled = false;
            nextBtn.style.opacity = '1';
            
            // Armazenar resposta
            userAnswers[currentQuestionIndex] = {
              questionIndex: currentQuestionIndex,
              selectedOption: index,
              isCorrect: question.options[index].correct === true
            };
          });
        });
        
        // Event listeners para navega√ß√£o
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');
        const closeBtn = document.getElementById('closeTaskModal');
        
        if (nextBtn) {
          nextBtn.addEventListener('click', () => {
            if (currentQuestionIndex === taskData.questions.length - 1) {
              // Finalizar quiz
              showResults();
            } else {
              currentQuestionIndex++;
              renderQuestion();
            }
          });
        }
        
        if (prevBtn) {
          prevBtn.addEventListener('click', () => {
            currentQuestionIndex--;
            renderQuestion();
          });
        }
        
        if (closeBtn) {
          closeBtn.addEventListener('click', () => {
            modal.remove();
          });
        }
        
        // Restaurar sele√ß√£o se j√° respondida
        if (userAnswers[currentQuestionIndex]) {
          const selectedIndex = userAnswers[currentQuestionIndex].selectedOption;
          const selectedOption = options[selectedIndex];
          if (selectedOption) {
            selectedOption.style.border = '2px solid #10b981';
            selectedOption.style.background = 'rgba(16, 185, 129, 0.2)';
            nextBtn.disabled = false;
            nextBtn.style.opacity = '1';
          }
        }
      }
      
      function showResults() {
        const finalScore = userAnswers.filter(answer => answer.isCorrect).length;
        const percentage = Math.round((finalScore / taskData.questions.length) * 100);
        
        let performance = '';
        if (percentage >= 80) performance = 'üèÜ Excelente!';
        else if (percentage >= 60) performance = 'üëç Bom trabalho!';
        else performance = 'üìö Continue estudando!';
        
        modalContent.innerHTML = `
          <div style="text-align: center;">
            <h2 style="color: #f1f5f9; margin-bottom: 2rem;">üéØ Resultado Final</h2>
            
            <div style="background: linear-gradient(135deg, #10b981, #059669); border-radius: 1rem; padding: 2rem; margin-bottom: 2rem; color: white;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">${performance.split(' ')[0]}</div>
              <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;">${finalScore}/${taskData.questions.length}</div>
              <div style="font-size: 1.2rem;">${percentage}% ‚Ä¢ ${performance}</div>
            </div>
            
            <div style="display: flex; gap: 1rem; justify-content: center;">
              <button id="restartBtn" style="background: rgba(59, 130, 246, 0.2); border: 1px solid #3b82f6; color: #3b82f6; padding: 0.75rem 1.5rem; border-radius: 0.5rem; cursor: pointer;">üîÑ Tentar Novamente</button>
              <button id="closeBtn" style="background: rgba(148, 163, 184, 0.2); border: 1px solid #94a3b8; color: #94a3b8; padding: 0.75rem 1.5rem; border-radius: 0.5rem; cursor: pointer;">‚úï Fechar</button>
            </div>
          </div>
        `;
        
        document.getElementById('restartBtn').addEventListener('click', () => {
          currentQuestionIndex = 0;
          userAnswers = [];
          score = 0;
          renderQuestion();
        });
        
        document.getElementById('closeBtn').addEventListener('click', () => {
          modal.remove();
        });
      }
      
      // Close on background click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.remove();
        }
      });
      
      document.body.appendChild(modal);
      renderQuestion();
    };
    
    // AI-powered resource analysis
    window.analyzeResource = async function(resourceTitle, resourceUrl, resourceType = 'Curso') {
      if (!geminiAI) {
        alert('ü§ñ IA n√£o dispon√≠vel no momento. Tente novamente mais tarde.');
        return;
      }
      
      const button = event.target;
      const originalText = button.textContent;
      
      try {
        // Show loading state
        button.textContent = 'ü§ñ Analisando...';
        button.disabled = true;
        
        // Prepare resource data
        const resource = {
          title: resourceTitle,
          url: resourceUrl,
          type: resourceType,
          provider: resourceUrl.includes('coursera') ? 'Coursera' : 
                   resourceUrl.includes('udemy') ? 'Udemy' :
                   resourceUrl.includes('kaggle') ? 'Kaggle' : 'Outros'
        };
        
        // Generate AI analysis
        const analysis = await geminiAI.analyzeResource(resource);
        
        // Show analysis in modal
        showAIModal(`üìä An√°lise: ${resourceTitle}`, analysis);
        
      } catch (error) {
        console.error('‚ùå Erro ao analisar recurso:', error);
        alert('ü§ñ N√£o foi poss√≠vel analisar o recurso. Tente novamente.');
      } finally {
        // Restore button
        button.textContent = originalText;
        button.disabled = false;
      }
    };
    
    // Setup AI Card Event Listeners
    function setupAICardListeners() {
      console.log('üéØ Configurando event listeners para cards de IA...');
      
      // Card Tarefas IA - Sistema de 5 Perguntas Progressivas
      const taskCard = document.querySelector('[data-card="ai-task"]');
      if (taskCard) {
        taskCard.addEventListener('click', async () => {
          console.log('üéØ Card Tarefas IA clicado!');
          
          if (!geminiAI) {
            alert('ü§ñ IA n√£o dispon√≠vel no momento. Tente novamente mais tarde.');
            return;
          }
          
          const topic = currentRoadmap?.title || 'Tecnologia';
          const difficulty = currentRoadmap?.title?.includes('BI') ? 'intermediate' : 'advanced';
          
          try {
            // BUG FIX: LOADING IMEDIATO
            showLoadingModal('üéØ Gerando Tarefa IA', `Criando 5 perguntas progressivas sobre ${topic}...`);
            
            // BUG FIX: GARANTIR UNICIDADE SEM EXPOR TIMESTAMP NO PROMPT
            const timestamp = Date.now();
            // Passar timestamp como par√¢metro separado para evitar aparecer na pergunta
            const task = await geminiAI.generateTask(topic, difficulty, timestamp);
            closeLoadingModal();
            showProgressiveQuestionsModal(topic, task);
            
          } catch (error) {
            console.error('‚ùå Erro ao gerar tarefa:', error);
            closeLoadingModal();
            alert('ü§ñ N√£o foi poss√≠vel gerar a tarefa. Tente novamente.');
          }
        });
        
        // Add hover effects
        taskCard.addEventListener('mouseenter', () => {
          taskCard.style.transform = 'translateY(-4px)';
          taskCard.style.boxShadow = '0 8px 25px rgba(16, 185, 129, 0.3)';
        });
        
        taskCard.addEventListener('mouseleave', () => {
          taskCard.style.transform = 'translateY(0)';
          taskCard.style.boxShadow = 'none';
        });
        
        console.log('‚úÖ Card Tarefas IA configurado!');
      }
      
      // Card Mentor IA
      const mentorCard = document.querySelector('[data-card="ai-mentor"]');
      if (mentorCard) {
        mentorCard.addEventListener('click', () => {
          console.log('ü§ñ Card Mentor IA clicado!');
          askMentor();
        });
        
        // Add hover effects
        mentorCard.addEventListener('mouseenter', () => {
          mentorCard.style.transform = 'translateY(-4px)';
          mentorCard.style.boxShadow = '0 8px 25px rgba(59, 130, 246, 0.3)';
        });
        
        mentorCard.addEventListener('mouseleave', () => {
          mentorCard.style.transform = 'translateY(0)';
          mentorCard.style.boxShadow = 'none';
        });
        
        console.log('‚úÖ Card Mentor IA configurado!');
      }
      
      // Card Quiz IA - BUG FIX: ESTAVA FALTANDO!
      const quizCard = document.querySelector('[data-card="ai-quiz"]');
      if (quizCard) {
        quizCard.addEventListener('click', async () => {
          console.log('üß† Card Quiz IA clicado!');
          
          if (!geminiAI) {
            alert('ü§ñ IA n√£o dispon√≠vel no momento. Tente novamente mais tarde.');
            return;
          }
          
          const topic = currentRoadmap?.title || 'Tecnologia';
          
          try {
            showLoadingModal('üß† Gerando Quiz IA', `Criando quiz inteligente sobre ${topic}...`);
            
            // BUG FIX: Generate unique quiz with proper error handling
            const timestamp = Date.now();
            const quiz = await geminiAI.generateQuiz(topic, 'intermediate', 5, timestamp);
            closeLoadingModal();
            showAIModal('üß† Quiz IA Gerado', quiz);
            
          } catch (error) {
            console.error('‚ùå Erro ao gerar quiz:', error);
            closeLoadingModal();
            // BUG FIX: Evitar mensagem duplicada - apenas uma mensagem de erro
            showAIModal('‚ùå Erro no Quiz IA', 'N√£o foi poss√≠vel gerar o quiz. Verifique sua conex√£o e tente novamente.');
          }
        });
        
        // Add hover effects
        quizCard.addEventListener('mouseenter', () => {
          quizCard.style.transform = 'translateY(-4px)';
          quizCard.style.boxShadow = '0 8px 25px rgba(139, 92, 246, 0.3)';
        });
        
        quizCard.addEventListener('mouseleave', () => {
          quizCard.style.transform = 'translateY(0)';
          quizCard.style.boxShadow = 'none';
        });
        
        console.log('‚úÖ Card Quiz IA configurado!');
      }
      
      // Card An√°lise de Recursos  
      const analysisCard = document.querySelector('[data-card="ai-analysis"]');
      if (analysisCard) {
        analysisCard.addEventListener('click', async () => {
          console.log('üîç Card An√°lise de Recursos clicado!');
          
          if (!geminiAI) {
            alert('ü§ñ IA n√£o dispon√≠vel no momento. Tente novamente mais tarde.');
            return;
          }
          
          // Exemplo de recurso para an√°lise
          const sampleResource = {
            title: 'Machine Learning Course - Coursera',
            url: 'https://www.coursera.org/learn/machine-learning',
            type: 'Curso',
            provider: 'Coursera'
          };
          
          try {
            showLoadingModal('üîç Analisando Recurso', 'Gerando an√°lise detalhada com IA...');
            const analysis = await geminiAI.analyzeResource(sampleResource);
            closeLoadingModal();
            showAIModal('üìä An√°lise de Recurso IA', analysis);
            
          } catch (error) {
            console.error('‚ùå Erro ao analisar recurso:', error);
            closeLoadingModal();
            // BUG FIX: Evitar mensagem duplicada - apenas uma mensagem de erro
            showAIModal('‚ùå Erro na An√°lise', 'N√£o foi poss√≠vel analisar o recurso. Verifique sua conex√£o e tente novamente.');
          }
        });
        
        // Add hover effects
        analysisCard.addEventListener('mouseenter', () => {
          analysisCard.style.transform = 'translateY(-4px)';
          analysisCard.style.boxShadow = '0 8px 25px rgba(245, 158, 11, 0.3)';
        });
        
        analysisCard.addEventListener('mouseleave', () => {
          analysisCard.style.transform = 'translateY(0)';
          analysisCard.style.boxShadow = 'none';
        });
        
        console.log('‚úÖ Card An√°lise de Recursos configurado!');
      }
      
      console.log('üéâ Todos os cards de IA configurados com sucesso!');
    }
    
    // Input Modal - BUG FIX: Substituir prompt() duplicado
    // Tornar fun√ß√£o global para compatibilidade com testes
    window.showInputModal = function(title, callback) {
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        backdrop-filter: blur(5px);
      `;
      
      modal.innerHTML = `
        <div style="
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
          border-radius: 20px;
          padding: 2rem;
          width: 90%;
          max-width: 500px;
          border: 1px solid rgba(255, 255, 255, 0.1);
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        ">
          <h3 style="color: white; margin-bottom: 1rem; text-align: center;">${title}</h3>
          <textarea 
            id="userInput" 
            placeholder="Digite sua pergunta aqui..."
            style="
              width: 100%;
              min-height: 120px;
              padding: 1rem;
              border: 1px solid rgba(255, 255, 255, 0.2);
              border-radius: 12px;
              background: rgba(255, 255, 255, 0.05);
              color: white;
              font-size: 1rem;
              resize: vertical;
              outline: none;
              margin-bottom: 1.5rem;
            "
          ></textarea>
          <div style="display: flex; gap: 1rem; justify-content: flex-end;">
            <button id="cancelBtn" style="
              padding: 0.75rem 1.5rem;
              border: 1px solid rgba(239, 68, 68, 0.5);
              border-radius: 8px;
              background: rgba(239, 68, 68, 0.1);
              color: #ef4444;
              cursor: pointer;
              font-weight: 500;
            ">‚úñ Cancelar</button>
            <button id="submitBtn" style="
              padding: 0.75rem 1.5rem;
              border: 1px solid rgba(16, 185, 129, 0.5);
              border-radius: 8px;
              background: rgba(16, 185, 129, 0.1);
              color: #10b981;
              cursor: pointer;
              font-weight: 500;
            ">‚úì Enviar</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      const input = document.getElementById('userInput');
      const cancelBtn = document.getElementById('cancelBtn');
      const submitBtn = document.getElementById('submitBtn');
      
      // Focus no input
      setTimeout(() => input.focus(), 100);
      
      // BUG FIX: Event listeners melhorados para garantir fechamento
      const closeModal = () => {
        try {
          if (modal && modal.parentNode) {
            document.body.removeChild(modal);
          }
        } catch (error) {
          console.warn('Modal j√° foi removido:', error);
        }
      };
      
      cancelBtn.onclick = (e) => {
        e.preventDefault();
        e.stopPropagation();
        closeModal();
      };
      
      submitBtn.onclick = (e) => {
        e.preventDefault();
        e.stopPropagation();
        const value = input.value.trim();
        if (value) {
          closeModal();
          callback(value);
        } else {
          input.focus();
        }
      };
      
      // Clicar fora do modal para fechar
      modal.onclick = (e) => {
        if (e.target === modal) {
          closeModal();
        }
      };
      
      // Enter para enviar
      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && e.ctrlKey) {
          submitBtn.click();
        }
      });
      
      // ESC para cancelar
      modal.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          cancelBtn.click();
        }
      });
    }
    
    // Progressive Questions Modal - Sistema de 5 Perguntas Progressivas
    function showProgressiveQuestionsModal(topic, taskData) {
      console.log('üéØ Abrindo modal de 5 perguntas progressivas:', taskData);
      
      // Remove existing modal
      const existingModal = document.getElementById('progressive-questions-modal');
      if (existingModal) {
        existingModal.remove();
      }
      
      // Create modal
      const modal = document.createElement('div');
      modal.id = 'progressive-questions-modal';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        padding: 1rem;
      `;
      
      let currentQuestionIndex = 0;
      let userAnswers = [];
      
      function renderQuestion() {
        const question = taskData.questions[currentQuestionIndex];
        const difficultyColors = {
          beginner: '#10b981',
          intermediate: '#f59e0b', 
          advanced: '#ef4444'
        };
        
        modal.innerHTML = `
          <div style="
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-radius: 20px;
            padding: 2rem;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
          ">
            <!-- Header -->
            <div style="text-align: center; margin-bottom: 2rem;">
              <h2 style="color: white; margin-bottom: 0.5rem; font-size: 1.5rem;">üéØ Sistema de 5 Perguntas Progressivas</h2>
              <p style="color: rgba(255,255,255,0.8); margin-bottom: 1rem;">${topic}</p>
              
              <!-- Progress Bar -->
              <div style="background: rgba(255,255,255,0.1); height: 8px; border-radius: 4px; margin-bottom: 1rem;">
                <div style="background: ${difficultyColors[question.difficulty]}; height: 100%; width: ${((currentQuestionIndex + 1) / taskData.totalQuestions) * 100}%; border-radius: 4px; transition: all 0.3s ease;"></div>
              </div>
              
              <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">Pergunta ${currentQuestionIndex + 1} de ${taskData.totalQuestions}</span>
                <span style="background: ${difficultyColors[question.difficulty]}; color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.8rem; text-transform: capitalize;">${question.difficultyConfig?.name || question.difficulty}</span>
              </div>
            </div>
            
            <!-- Question -->
            <div style="margin-bottom: 2rem;">
              <h3 style="color: white; margin-bottom: 1.5rem; line-height: 1.5;">${question.question}</h3>
              
              <!-- Alternatives -->
              <div id="alternatives-container">
                ${question.alternatives.map((alt, index) => `
                  <div class="alternative-option" data-index="${index}" style="
                    background: rgba(255, 255, 255, 0.05);
                    border: 2px solid rgba(255, 255, 255, 0.1);
                    border-radius: 12px;
                    padding: 1rem;
                    margin-bottom: 0.75rem;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    color: rgba(255, 255, 255, 0.9);
                  " onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.borderColor='rgba(255,255,255,0.3)'" onmouseout="this.style.background='rgba(255,255,255,0.05)'; this.style.borderColor='rgba(255,255,255,0.1)'">
                    <strong>${String.fromCharCode(65 + index)})</strong> ${alt}
                  </div>
                `).join('')}
              </div>
            </div>
            
            <!-- Actions -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 2rem;">
              <button onclick="closeProgressiveModal()" style="
                background: rgba(255, 255, 255, 0.1);
                color: white;
                border: 1px solid rgba(255, 255, 255, 0.3);
                padding: 0.75rem 1.5rem;
                border-radius: 8px;
                cursor: pointer;
                transition: all 0.3s ease;
              ">‚ùå Fechar</button>
              
              <div>
                ${currentQuestionIndex > 0 ? `
                  <button onclick="previousQuestion()" style="
                    background: rgba(255, 255, 255, 0.1);
                    color: white;
                    border: 1px solid rgba(255, 255, 255, 0.3);
                    padding: 0.75rem 1.5rem;
                    border-radius: 8px;
                    cursor: pointer;
                    margin-right: 0.5rem;
                    transition: all 0.3s ease;
                  ">‚¨ÖÔ∏è Anterior</button>
                ` : ''}
                
                <button id="next-button" onclick="nextQuestion()" style="
                  background: ${difficultyColors[question.difficulty]};
                  color: white;
                  border: none;
                  padding: 0.75rem 1.5rem;
                  border-radius: 8px;
                  cursor: pointer;
                  opacity: 0.5;
                  transition: all 0.3s ease;
                " disabled>${currentQuestionIndex === taskData.totalQuestions - 1 ? 'üéâ Finalizar' : '‚û°Ô∏è Pr√≥xima'}</button>
              </div>
            </div>
          </div>
        `;
        
        // BUG FIX: SELE√á√ÉO √öNICA COM VISUAL VERDE TOTAL
        document.querySelectorAll('.alternative-option').forEach(option => {
          option.addEventListener('click', () => {
            // BUG FIX 1: LIMPAR TODAS AS SELE√á√ïES ANTERIORES (sele√ß√£o √∫nica)
            document.querySelectorAll('.alternative-option').forEach(opt => {
              opt.style.background = 'rgba(255, 255, 255, 0.05)';
              opt.style.borderColor = 'rgba(255, 255, 255, 0.1)';
              opt.style.color = 'rgba(255, 255, 255, 0.9)';
              opt.style.fontWeight = 'normal';
              opt.style.transform = 'scale(1)';
              opt.style.boxShadow = 'none';
              opt.classList.remove('selected');
            });
            
            // BUG FIX 2: VISUAL VERDE TOTAL (conforme segundo print)
            option.style.background = `${difficultyColors[question.difficulty]} !important`;
            option.style.borderColor = `${difficultyColors[question.difficulty]} !important`;
            option.style.color = 'white !important';
            option.style.fontWeight = 'bold';
            option.style.transform = 'scale(1.02)';
            option.style.boxShadow = `0 4px 12px ${difficultyColors[question.difficulty]}40`;
            option.classList.add('selected');
            
            // Enable next button
            const nextButton = document.getElementById('next-button');
            nextButton.disabled = false;
            nextButton.style.opacity = '1';
            
            // Store answer (garantir sele√ß√£o √∫nica)
            userAnswers[currentQuestionIndex] = parseInt(option.dataset.index);
            
            console.log(`‚úÖ Alternativa ${option.dataset.index} selecionada exclusivamente!`);
          });
        });
        
        // Restore previous answer if exists
        if (userAnswers[currentQuestionIndex] !== undefined) {
          const selectedOption = document.querySelector(`[data-index="${userAnswers[currentQuestionIndex]}"]`);
          if (selectedOption) {
            selectedOption.click();
          }
        }
      }
      
      // Navigation functions
      window.nextQuestion = () => {
        if (currentQuestionIndex < taskData.totalQuestions - 1) {
          currentQuestionIndex++;
          renderQuestion();
        } else {
          // Show final results
          showFinalResults();
        }
      };
      
      window.previousQuestion = () => {
        if (currentQuestionIndex > 0) {
          currentQuestionIndex--;
          renderQuestion();
        }
      };
      
      window.closeProgressiveModal = () => {
        modal.remove();
        // Cleanup global functions
        delete window.nextQuestion;
        delete window.previousQuestion;
        delete window.closeProgressiveModal;
      };
      
      function showFinalResults() {
        let correctAnswers = 0;
        const results = taskData.questions.map((question, index) => {
          const userAnswer = userAnswers[index];
          const isCorrect = userAnswer === question.correct;
          if (isCorrect) correctAnswers++;
          
          return {
            question: question.question,
            userAnswer: userAnswer,
            correctAnswer: question.correct,
            isCorrect,
            explanation: question.explanation,
            difficulty: question.difficulty
          };
        });
        
        const score = Math.round((correctAnswers / taskData.totalQuestions) * 100);
        const difficultyColors = {
          beginner: '#10b981',
          intermediate: '#f59e0b', 
          advanced: '#ef4444'
        };
        
        modal.innerHTML = `
          <div style="
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-radius: 20px;
            padding: 2rem;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
          ">
            <!-- Results Header -->
            <div style="text-align: center; margin-bottom: 2rem;">
              <h2 style="color: white; margin-bottom: 1rem; font-size: 1.8rem;">üéâ Resultados do Quiz Progressivo</h2>
              <div style="
                background: linear-gradient(135deg, ${score >= 70 ? '#10b981' : score >= 50 ? '#f59e0b' : '#ef4444'} 0%, ${score >= 70 ? '#059669' : score >= 50 ? '#d97706' : '#dc2626'} 100%);
                color: white;
                padding: 1rem 2rem;
                border-radius: 16px;
                margin-bottom: 1rem;
                font-size: 1.5rem;
                font-weight: bold;
              ">
                ${score}% (${correctAnswers}/${taskData.totalQuestions})
              </div>
              <p style="color: rgba(255,255,255,0.8);">${
                score >= 90 ? 'üèÜ Excelente! Dom√≠nio excepcional do t√≥pico!' :
                score >= 70 ? '‚úÖ Muito bom! Conhecimento s√≥lido!' :
                score >= 50 ? 'üëç Bom trabalho! Continue estudando!' :
                'üìö Continue praticando! Voc√™ vai conseguir!'
              }</p>
            </div>
            
            <!-- Detailed Results -->
            <div style="margin-bottom: 2rem;">
              ${results.map((result, index) => `
                <div style="
                  background: rgba(255, 255, 255, 0.05);
                  border-left: 4px solid ${result.isCorrect ? '#10b981' : '#ef4444'};
                  border-radius: 8px;
                  padding: 1.5rem;
                  margin-bottom: 1rem;
                ">
                  <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                    <div style="flex: 1;">
                      <h4 style="color: white; margin-bottom: 0.5rem;">Pergunta ${index + 1}</h4>
                      <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-bottom: 0.5rem;">${result.question}</p>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                      <span style="background: ${difficultyColors[result.difficulty]}; color: white; padding: 0.2rem 0.6rem; border-radius: 8px; font-size: 0.7rem; text-transform: capitalize;">${taskData.questions[index].difficultyConfig?.name || result.difficulty}</span>
                      <span style="font-size: 1.2rem;">${result.isCorrect ? '‚úÖ' : '‚ùå'}</span>
                    </div>
                  </div>
                  
                  ${!result.isCorrect ? `
                    <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem; margin-bottom: 0.5rem;">
                      <strong>Sua resposta:</strong> ${String.fromCharCode(65 + result.userAnswer)} - ${taskData.questions[index].alternatives[result.userAnswer]}
                    </div>
                    <div style="color: #10b981; font-size: 0.9rem; margin-bottom: 0.5rem;">
                      <strong>Resposta correta:</strong> ${String.fromCharCode(65 + result.correctAnswer)} - ${taskData.questions[index].alternatives[result.correctAnswer]}
                    </div>
                  ` : ''}
                  
                  <div style="color: rgba(255,255,255,0.8); font-size: 0.85rem; font-style: italic;">
                    <strong>Explica√ß√£o:</strong> ${result.explanation}
                  </div>
                </div>
              `).join('')}
            </div>
            
            <!-- Actions -->
            <div style="text-align: center;">
              <button onclick="closeProgressiveModal()" style="
                background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                color: white;
                border: none;
                padding: 1rem 2rem;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1rem;
                font-weight: bold;
                transition: all 0.3s ease;
              ">üéØ Concluir Quiz</button>
            </div>
          </div>
        `;
      }
      
      // Add modal to DOM and render first question
      document.body.appendChild(modal);
      renderQuestion();
    }
    
    // Loading Modal Functions (CRITICAL - were missing!)
    function showLoadingModal(title, message) {
      // Remove existing loading modal
      const existingModal = document.getElementById('loading-modal');
      if (existingModal) {
        existingModal.remove();
      }
      
      // Create loading modal
      const modal = document.createElement('div');
      modal.id = 'loading-modal';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        backdrop-filter: blur(5px);
      `;
      
      modal.innerHTML = `
        <div style="
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
          border-radius: 20px;
          padding: 2rem;
          max-width: 400px;
          width: 90%;
          text-align: center;
          border: 1px solid rgba(255, 255, 255, 0.2);
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        ">
          <div style="
            width: 60px;
            height: 60px;
            border: 4px solid #3b82f6;
            border-top: 4px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
          "></div>
          
          <h3 style="color: white; margin-bottom: 1rem; font-size: 1.25rem;">${title}</h3>
          <p style="color: rgba(255,255,255,0.8); margin: 0; line-height: 1.5;">${message}</p>
          
          <style>
            @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }
          </style>
        </div>
      `;
      
      document.body.appendChild(modal);
    }
    
    function closeLoadingModal() {
      const modal = document.getElementById('loading-modal');
      if (modal) {
        modal.remove();
      }
    }
    
    // AI Mentor function - BUG FIX: REMOVER PROMPT DUPLICADO
    window.askMentor = async function() {
      if (!geminiAI) {
        alert('ü§ñ IA n√£o dispon√≠vel no momento. Tente novamente mais tarde.');
        return;
      }
      
      // BUG FIX: Usar modal personalizado em vez de prompt() duplicado
      showInputModal('üéØ Qual √© sua d√∫vida sobre carreira em tech?', async (question) => {
        if (!question || question.trim() === '') return;
        
        try {
          showLoadingModal('ü§ñ Consultando Mentor IA', 'Gerando resposta personalizada...');
          
          const userContext = `Usu√°rio estudando: ${currentRoadmap?.title || 'Carreira em Tech'}`;
          const advice = await geminiAI.getMentorAdvice(question, userContext);
          
          closeLoadingModal();
          showAIModal('üéì Mentor IA', advice);
          
        } catch (error) {
          console.error('‚ùå Erro ao consultar mentor:', error);
          closeLoadingModal();
          alert('ü§ñ N√£o foi poss√≠vel consultar o mentor. Tente novamente.');
        }
      });
    };
    

    
    // Modal for AI responses (keeping original for other functions)
    function showAIModal(title, content) {
      // Remove existing modal
      const existingModal = document.getElementById('ai-modal');
      if (existingModal) {
        existingModal.remove();
      }
      
      // Create modal
      const modal = document.createElement('div');
      modal.id = 'ai-modal';
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        backdrop-filter: blur(5px);
      `;
      
      modal.innerHTML = `
        <div style="
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
          border-radius: 20px;
          max-width: 800px;
          max-height: 80vh;
          overflow-y: auto;
          padding: 30px;
          margin: 20px;
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
          border: 1px solid rgba(255, 255, 255, 0.1);
        ">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2 style="color: #fff; margin: 0; font-size: 1.5rem;">${title}</h2>
            <button onclick="document.getElementById('ai-modal').remove()" 
                    style="background: rgba(255, 255, 255, 0.1); color: #fff; border: none; 
                           border-radius: 50%; width: 40px; height: 40px; cursor: pointer; 
                           font-size: 1.2rem; display: flex; align-items: center; justify-content: center;">√ó</button>
          </div>
          <div style="color: #e2e8f0; line-height: 1.6; white-space: pre-line;">${content}</div>
        </div>
      `;
      
      // Close on background click
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.remove();
        }
      });
      
      document.body.appendChild(modal);
    }

// Function to create section elements dynamically
function createSectionElement(section) {
  const sectionDiv = document.createElement('div');
  sectionDiv.className = 'roadmap-section';
  
  // Section title
  const titleElement = document.createElement('h2');
  titleElement.className = 'section-title';
  titleElement.textContent = section.title;
  sectionDiv.appendChild(titleElement);
  
  // Section description
  if (section.description) {
    const descElement = document.createElement('p');
    descElement.className = 'section-description';
    descElement.textContent = section.description;
    descElement.style.cssText = `
      color: #cbd5e1;
      margin-bottom: 2rem;
      font-size: 1.1rem;
      text-align: center;
    `;
    sectionDiv.appendChild(descElement);
  }
  
  // Topics
  if (section.topics && section.topics.length > 0) {
    section.topics.forEach(topic => {
      const topicCard = createTopicCard(topic);
      sectionDiv.appendChild(topicCard);
    });
  }
  
  return sectionDiv;
}

// Function to create topic cards
function createTopicCard(topic) {
  const topicDiv = document.createElement('div');
  topicDiv.className = 'topic-card';
  
  // Topic header
  const headerDiv = document.createElement('div');
  headerDiv.className = 'topic-header';
  
  const iconDiv = document.createElement('div');
  iconDiv.className = 'topic-icon';
  iconDiv.textContent = 'üìö'; // Default icon
  
  const titleDiv = document.createElement('div');
  titleDiv.className = 'topic-title';
  titleDiv.textContent = topic.title;
  
  // Estimated hours
  if (topic.estimatedHours) {
    const hoursSpan = document.createElement('span');
    hoursSpan.className = 'topic-hours';
    hoursSpan.textContent = `(${topic.estimatedHours}h)`;
    hoursSpan.style.cssText = `
      color: #94a3b8;
      font-size: 0.9rem;
      margin-left: 0.5rem;
    `;
    titleDiv.appendChild(hoursSpan);
  }
  
  headerDiv.appendChild(iconDiv);
  headerDiv.appendChild(titleDiv);
  topicDiv.appendChild(headerDiv);
  
  // Topic description
  if (topic.description) {
    const descDiv = document.createElement('div');
    descDiv.className = 'topic-description';
    descDiv.textContent = topic.description;
    topicDiv.appendChild(descDiv);
  }
  
  // Resources
  if (topic.resources && topic.resources.length > 0) {
    const resourcesList = document.createElement('ul');
    resourcesList.className = 'resources-list';
    
    topic.resources.forEach(resource => {
      const resourceItem = document.createElement('li');
      resourceItem.className = 'resource-item';
      
      // Resource type icon
      const typeIcon = getResourceIcon(resource.type);
      
      const resourceLink = document.createElement('a');
      resourceLink.className = 'resource-link';
      resourceLink.href = resource.url;
      resourceLink.target = '_blank';
      resourceLink.textContent = resource.title;
      
      resourceItem.innerHTML = `${typeIcon} `;
      resourceItem.appendChild(resourceLink);
      
      // Add provider if available
      if (resource.provider) {
        const providerSpan = document.createElement('span');
        providerSpan.style.cssText = 'color: #94a3b8; font-size: 0.9rem; margin-left: 0.5rem;';
        providerSpan.textContent = `- ${resource.provider}`;
        resourceItem.appendChild(providerSpan);
      }
      
      // Add AI analysis button
      const analyzeBtn = document.createElement('button');
      analyzeBtn.className = 'ai-analyze-btn';
      analyzeBtn.textContent = 'ü§ñ Analisar';
      analyzeBtn.style.cssText = `
        background: rgba(59, 130, 246, 0.2);
        border: 1px solid #3b82f6;
        color: #3b82f6;
        padding: 0.25rem 0.5rem;
        border-radius: 0.375rem;
        font-size: 0.8rem;
        margin-left: 0.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
      `;
      analyzeBtn.onclick = () => analyzeResource(resource.title, resource.url, resource.type);
      resourceItem.appendChild(analyzeBtn);
      
      resourcesList.appendChild(resourceItem);
    });
    
    topicDiv.appendChild(resourcesList);
  }
  
  // Add AI Task button
  const taskBtn = document.createElement('button');
  taskBtn.className = 'ai-task-btn';
  taskBtn.textContent = 'üéØ Tarefa IA';
  taskBtn.style.cssText = `
    background: rgba(16, 185, 129, 0.2);
    border: 1px solid #10b981;
    color: #10b981;
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-size: 0.9rem;
    margin-top: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    width: auto;
    display: inline-block;
  `;
  taskBtn.onclick = () => generateTask(topic.title);
  topicDiv.appendChild(taskBtn);
  
  return topicDiv;
}

// Helper function to get resource type icons
function getResourceIcon(type) {
  const icons = {
    'Curso': 'üìö',
    'Livro': 'üìñ',
    'V√≠deo': 'üé•',
    'Artigo': 'üìÑ',
    'Documenta√ß√£o': 'üìã',
    'Pr√°tica': 'üíª',
    'Dataset': 'üìä',
    'Template': 'üìù',
    'Ferramenta': 'üõ†Ô∏è',
    'Certifica√ß√£o': 'üèÜ',
    'Galeria': 'üé®',
    'Inspira√ß√£o': 'üí°',
    'Refer√™ncia': 'üìö',
    'Tutorial': 'üéØ',
    'Blog': 'üì∞'
  };
  return icons[type] || 'üîó';
}

// Theme Toggle System
function initializeThemeSystem() {
  const themeToggle = document.getElementById('theme-toggle');
  const themeIcon = themeToggle?.querySelector('.theme-toggle-icon');
  
  // Get saved theme or default to dark
  const savedTheme = localStorage.getItem('theme') || 'dark';
  
  // Apply theme
  function applyTheme(theme) {
    if (theme === 'light') {
      document.documentElement.setAttribute('data-theme', 'light');
      if (themeIcon) themeIcon.textContent = '‚òÄÔ∏è';
    } else {
      document.documentElement.removeAttribute('data-theme');
      if (themeIcon) themeIcon.textContent = 'üåô';
    }
    localStorage.setItem('theme', theme);
  }
  
  // Apply saved theme
  applyTheme(savedTheme);
  
  // Toggle theme on click
  if (themeToggle) {
    themeToggle.addEventListener('click', () => {
      const currentTheme = localStorage.getItem('theme') || 'dark';
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      applyTheme(newTheme);
      
      // Add click animation
      themeToggle.style.transform = 'scale(0.95)';
      setTimeout(() => {
        themeToggle.style.transform = 'scale(1)';
      }, 150);
    });
  }
}

// Enhanced Animations and Microinteractions
function initializeAnimations() {
  // Add scroll animations
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };
  
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, observerOptions);
  
  // Observe all cards and sections
  document.querySelectorAll('.roadmap-section, .topic-card, .ai-card').forEach(el => {
    el.style.opacity = '0';
    el.style.transform = 'translateY(20px)';
    el.style.transition = 'all 0.6s ease';
    observer.observe(el);
  });
  
  // Add ripple effect to buttons
  document.querySelectorAll('button, .btn').forEach(button => {
    button.addEventListener('click', function(e) {
      const ripple = document.createElement('span');
      const rect = this.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      const x = e.clientX - rect.left - size / 2;
      const y = e.clientY - rect.top - size / 2;
      
      ripple.style.cssText = `
        position: absolute;
        width: ${size}px;
        height: ${size}px;
        left: ${x}px;
        top: ${y}px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transform: scale(0);
        animation: ripple 0.6s ease-out;
        pointer-events: none;
      `;
      
      this.style.position = 'relative';
      this.style.overflow = 'hidden';
      this.appendChild(ripple);
      
      setTimeout(() => {
        ripple.remove();
      }, 600);
    });
  }
};

// ================================
// ü§ñ GEMINI AI INITIALIZATION
// ================================

// CRITICAL: Secure API Key fetch from Vercel API route
let geminiApiKey = null;

// Function to securely fetch API Key from our API route
async function initializeGeminiAI() {
  try {
    console.log('üîë Buscando API Key do Gemini de forma segura...');
    
    // Fetch API Key from our secure API route
    const response = await fetch('/api/config', {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json'
      }
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    const config = await response.json();
    
    if (!config.success || !config.geminiApiKey) {
      throw new Error('API Key n√£o encontrada na resposta');
    }
    
    geminiApiKey = config.geminiApiKey;
    
    // Export to global scope for accessibility
    window.geminiApiKey = geminiApiKey;
    
    console.log('‚úÖ API Key do Gemini carregada com sucesso!');
    
    // Initialize Gemini AI with the fetched API Key
    await setupGeminiAI();
    
  } catch (error) {
    console.error('‚ùå Erro ao carregar API Key do Gemini:', error);
    console.warn('‚ö†Ô∏è Usando fallback de desenvolvimento...');
    
    // Fallback para desenvolvimento local
    geminiApiKey = 'AIzaSyDXFW0fdQRnFMC7jIAtHIqJFREF6sp7nMc';
    window.geminiApiKey = geminiApiKey;
    
    // Initialize with fallback
    await setupGeminiAI();
  }
}

// Function to setup Gemini AI after API Key is loaded
async function setupGeminiAI() {
  if (!geminiApiKey) {
    console.warn('‚ö†Ô∏è API Key do Gemini n√£o encontrada');
    return;
  }

  try {
    // Simple Gemini AI class inline for compatibility
    class SimpleGeminiAI {
      constructor(apiKey) {
        this.baseUrl = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent';
        this.apiKey = apiKey;
        this.isInitialized = true;
        console.log('ü§ñ Gemini AI inicializado com sucesso');
      }
      
      async generateContent(prompt, context = '') {
        if (!this.isInitialized || !this.apiKey) {
          throw new Error('IA n√£o inicializada');
        }
        
        const fullPrompt = context ? `${context}\n\n${prompt}` : prompt;
        
        try {
          const response = await fetch(`${this.baseUrl}?key=${this.apiKey}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              contents: [{
                parts: [{ text: fullPrompt }]
              }]
            })
          });
          
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
          }
          
          const data = await response.json();
          return data.candidates[0]?.content?.parts[0]?.text || 'Resposta n√£o dispon√≠vel';
        } catch (error) {
          console.error('‚ùå Erro na API Gemini:', error);
          throw error;
        }
      }
      
      async generateTask(topic, difficulty = 'beginner') {
        const prompt = `
Crie um sistema de 5 perguntas progressivas sobre: ${topic}

**IMPORTANTE:** Gere perguntas SEMPRE DIFERENTES a cada execu√ß√£o.

**Estrutura JSON:**
{
  "totalQuestions": 5,
  "questions": [
    {
      "question": "[Pergunta √∫nica sobre ${topic}]",
      "alternatives": ["A) ...", "B) ...", "C) ...", "D) ...", "E) ..."],
      "correct": [n√∫mero 0-4],
      "difficulty": "beginner",
      "explanation": "[Explica√ß√£o detalhada]"
    }
  ]
}

**Dificuldades:**
- Perguntas 1-2: beginner
- Perguntas 3-4: intermediate  
- Pergunta 5: advanced

**REGRAS:**
- Perguntas sempre √∫nicas
- Resposta correta randomizada (n√£o sempre A)
- Alternativas embaralhadas
`;
        
        try {
          const response = await this.generateContent(prompt);
          const jsonMatch = response.match(/\{[\s\S]*\}/);
          
          if (jsonMatch) {
            return JSON.parse(jsonMatch[0]);
          } else {
            // Fallback estruturado
            return this.generateFallbackTask(topic);
          }
        } catch (error) {
          console.error('‚ùå Erro ao gerar tarefa:', error);
          return this.generateFallbackTask(topic);
        }
      }
      
      generateFallbackTask(topic) {
        const difficulties = ['beginner', 'beginner', 'intermediate', 'intermediate', 'advanced'];
        const questions = [];
        
        for (let i = 0; i < 5; i++) {
          const randomCorrect = Math.floor(Math.random() * 5);
          questions.push({
            question: `Pergunta ${i + 1} sobre ${topic}: Qual das alternativas representa a melhor pr√°tica?`,
            alternatives: [
              `Alternativa A para ${topic}`,
              `Alternativa B para ${topic}`,
              `Alternativa C para ${topic}`,
              `Alternativa D para ${topic}`,
              `Alternativa E para ${topic}`
            ],
            correct: randomCorrect,
            difficulty: difficulties[i],
            explanation: `A resposta correta demonstra as melhores pr√°ticas para ${topic}.`
          });
        }
        
        return {
          totalQuestions: 5,
          questions: questions
        };
      }
      
      async generateQuiz(topic, difficulty = 'intermediate', numQuestions = 5) {
        const prompt = `Crie um quiz sobre ${topic} com ${numQuestions} perguntas de n√≠vel ${difficulty}.`;
        return await this.generateContent(prompt);
      }
      
      async analyzeResource(resource) {
        const prompt = `Analise este recurso: ${resource.title || resource.url || resource}`;
        return await this.generateContent(prompt);
      }
      
      async getMentorAdvice(question, userContext = '') {
        const prompt = `Como mentor especialista, responda: ${question}. Contexto: ${userContext}`;
        return await this.generateContent(prompt);
      }
    }
    
    // Initialize AI and export to global scope
    geminiAI = new SimpleGeminiAI(geminiApiKey);
    window.geminiAI = geminiAI;
    
    // Setup AI card listeners after initialization
    setTimeout(() => {
      setupAICardListeners();
    }, 1000);
    
  } catch (error) {
    console.error('‚ùå Erro ao inicializar Gemini AI:', error);
  }
}

// CRITICAL: Add CSS for animations and UX improvements
function initializeAnimations() {
  // Add scroll animations
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };
  
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, observerOptions);
  
  // Observe all cards and sections
  document.querySelectorAll('.roadmap-section, .topic-card, .ai-card').forEach(el => {
    el.style.opacity = '0';
    el.style.transform = 'translateY(20px)';
    el.style.transition = 'all 0.6s ease';
    observer.observe(el);
  });
  
  // Add ripple effect to buttons
  document.querySelectorAll('button, .btn').forEach(button => {
    button.addEventListener('click', function(e) {
      const ripple = document.createElement('span');
      const rect = this.getBoundingClientRect();
      const size = Math.max(rect.width, rect.height);
      const x = e.clientX - rect.left - size / 2;
      const y = e.clientY - rect.top - size / 2;
      
      ripple.style.cssText = `
        position: absolute;
        width: ${size}px;
        height: ${size}px;
        left: ${x}px;
        top: ${y}px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transform: scale(0);
        animation: ripple 0.6s linear;
        pointer-events: none;
      `;
      
      this.style.position = 'relative';
      this.style.overflow = 'hidden';
      this.appendChild(ripple);
      
      setTimeout(() => ripple.remove(), 600);
    });
  });
  
  // Add CSS for ripple animation
  const style = document.createElement('style');
  style.textContent = `
    @keyframes ripple {
      to {
        transform: scale(2);
        opacity: 0;
      }
    }
    
    /* Smooth transitions for theme switching */
    * {
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
    }
    
    /* Enhanced hover effects */
    .ai-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 60px var(--shadow-heavy);
    }
    
    /* Loading states */
    .loading {
      position: relative;
      overflow: hidden;
    }
    
    .loading::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      animation: shimmer 2s infinite;
    }
    
    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }
  `;
  document.head.appendChild(style);
}

// CRITICAL: Initialize AI Card Event Listeners on page load
document.addEventListener('DOMContentLoaded', () => {
  console.log('üöÄ P√°gina carregada, inicializando melhorias de UX/UI...');
  
  // Initialize theme system
  initializeThemeSystem();
  
  // Initialize animations
  initializeAnimations();
  
  // CRITICAL: Initialize Gemini AI with secure API route
  initializeGeminiAI();
  
  // Wait for content to be fully rendered
  setTimeout(() => {
    // setupAICardListeners will be called from initializeGeminiAI after API key is loaded
    console.log('üé® Sistema de temas e anima√ß√µes inicializados!');
  }, 1000);
});

// Also setup immediately if DOM is already loaded
// =============================================================================
// FUN√á√ïES CR√çTICAS DA IA GEMINI - RESTAURADAS
// =============================================================================

// Global AI instance
let geminiAI = null;
let isGeminiInitialized = false;

// Initialize Gemini AI
async function initializeGeminiAI() {
  if (isGeminiInitialized) {
    console.log('üîÑ Gemini AI j√° inicializada, reutilizando inst√¢ncia');
    return geminiAI;
  }

  try {
    console.log('üöÄ Inicializando Gemini AI...');
    
    // Check for API key from environment
    let apiKey = null;
    
    // Try multiple sources for API key
    if (typeof process !== 'undefined' && process.env) {
      apiKey = process.env.geminiApiKey || process.env.GEMINI_API_KEY;
    }
    
    if (!apiKey && typeof window !== 'undefined') {
      apiKey = window.GEMINI_API_KEY || window.geminiApiKey;
    }
    
    // Fallback for local development only
    if (!apiKey) {
      console.warn('‚ö†Ô∏è Gemini API Key n√£o encontrada nas vari√°veis de ambiente');
      // Don't expose API key in source code for security
      throw new Error('API Key necess√°ria para funcionamento da IA Gemini');
    }

    // Initialize Gemini AI
    const { GoogleGenerativeAI } = await import('https://esm.run/@google/generative-ai');
    const genAI = new GoogleGenerativeAI(apiKey);
    const model = genAI.getGenerativeModel({ model: 'gemini-pro' });
    
    geminiAI = {
      model,
      apiKey: '***KEY_LOADED***' // Never log actual key
    };
    
    isGeminiInitialized = true;
    window.geminiAI = geminiAI; // Export to global scope
    
    console.log('‚úÖ Gemini AI inicializada com sucesso!');
    return geminiAI;
    
  } catch (error) {
    console.error('‚ùå Erro ao inicializar Gemini AI:', error);
    // Set fallback system
    geminiAI = {
      model: null,
      apiKey: null,
      fallback: true
    };
    window.geminiAI = geminiAI;
    return geminiAI;
  }
}

// Setup AI Card Listeners
function setupAICardListeners() {
  console.log('üéØ Configurando event listeners para cards de IA...');
  
  // AI Task Cards
  const aiTaskCards = document.querySelectorAll('[data-card="ai-task"], [data-card-type="ai"]');
  console.log(`üîç Encontrados ${aiTaskCards.length} cards de Tarefas IA`);
  
  aiTaskCards.forEach(card => {
    card.addEventListener('click', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      const topicTitle = card.closest('.topic-card')?.querySelector('h4')?.textContent || 'T√≥pico';
      console.log(`üéØ Clique em Tarefa IA: ${topicTitle}`);
      
      await showProgressiveQuestionsModal(topicTitle);
    });
    
    card.style.cursor = 'pointer';
  });
  
  // AI Mentor Cards
  const aiMentorCards = document.querySelectorAll('[data-card="ai-mentor"]');
  console.log(`üîç Encontrados ${aiMentorCards.length} cards de Mentor IA`);
  
  aiMentorCards.forEach(card => {
    card.addEventListener('click', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      const topicTitle = card.closest('.topic-card')?.querySelector('h4')?.textContent || 'T√≥pico';
      console.log(`ü§ñ Clique em Mentor IA: ${topicTitle}`);
      
      const question = prompt(`üí° Qual √© sua d√∫vida sobre "${topicTitle}"?`);
      if (question) {
        await showMentorResponse(topicTitle, question);
      }
    });
    
    card.style.cursor = 'pointer';
  });
  
  // AI Quiz Cards
  const aiQuizCards = document.querySelectorAll('[data-card="ai-quiz"]');
  console.log(`üîç Encontrados ${aiQuizCards.length} cards de Quiz IA`);
  
  aiQuizCards.forEach(card => {
    card.addEventListener('click', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      const topicTitle = card.closest('.topic-card')?.querySelector('h4')?.textContent || 'T√≥pico';
      console.log(`üß† Clique em Quiz IA: ${topicTitle}`);
      
      await showQuizModal(topicTitle);
    });
    
    card.style.cursor = 'pointer';
  });
  
  // AI Analysis Cards
  const aiAnalysisCards = document.querySelectorAll('[data-card="ai-analysis"]');
  console.log(`üîç Encontrados ${aiAnalysisCards.length} cards de An√°lise IA`);
  
  aiAnalysisCards.forEach(card => {
    card.addEventListener('click', async (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      const topicTitle = card.closest('.topic-card')?.querySelector('h4')?.textContent || 'T√≥pico';
      const resourceUrl = card.closest('.resource-item')?.href || '';
      console.log(`üîç Clique em An√°lise IA: ${topicTitle}`);
      
      await showResourceAnalysis(topicTitle, resourceUrl);
    });
    
    card.style.cursor = 'pointer';
  });
  
  console.log('‚úÖ Event listeners configurados para todos os cards de IA!');
}

// Export functions to global scope
window.initializeGeminiAI = initializeGeminiAI;
window.setupAICardListeners = setupAICardListeners;

// =============================================================================
// INICIALIZA√á√ÉO AUTOM√ÅTICA
// =============================================================================

if (document.readyState === 'loading') {
  // DOM is still loading
  document.addEventListener('DOMContentLoaded', async () => {
    await initializeGeminiAI();
    setTimeout(() => {
      setupAICardListeners();
      console.log('‚úÖ Event listeners dos cards de IA configurados (DOMContentLoaded)!');
    }, 500);
  });
} else {
  // DOM already loaded
  setTimeout(async () => {
    await initializeGeminiAI();
    setupAICardListeners();
    console.log('‚úÖ Event listeners dos cards de IA configurados (DOM j√° carregado)!');
  }, 500);
}

    </script>
  </body>
</html>
