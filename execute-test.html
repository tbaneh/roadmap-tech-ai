<!DOCTYPE html>
<html>
<head>
    <title>Execute Production Test</title>
</head>
<body>
    <h1>Executando Teste Automatizado em Produ√ß√£o</h1>
    <p>Este arquivo executar√° o teste diretamente na p√°gina de produ√ß√£o.</p>
    
    <script>
        // Abrir p√°gina de produ√ß√£o e executar teste
        setTimeout(() => {
            const prodWindow = window.open('https://roadmap-tech-ai.vercel.app/pages/roadmap.html?id=data-scientist', 'production');
            
            // Aguardar p√°gina carregar e executar teste
            setTimeout(() => {
                if (prodWindow && !prodWindow.closed) {
                    // Script de teste direto
                    const testScript = `
                        console.log('üö® TESTE AUTOMATIZADO - BUGS CR√çTICOS');
                        console.log('=====================================');
                        
                        async function testBugsRapido() {
                            const bugs = [];
                            
                            // TESTE 1: Verificar cards existem
                            const cards = {
                                tarefas: document.querySelector('[data-card="ai-task"]'),
                                mentor: document.querySelector('[data-card="ai-mentor"]'),
                                quiz: document.querySelector('[data-card="ai-quiz"]'),
                                analisar: document.querySelector('[data-card="ai-analyze"]')
                            };
                            
                            console.log('üìã Cards encontrados:', {
                                tarefas: !!cards.tarefas,
                                mentor: !!cards.mentor,
                                quiz: !!cards.quiz,
                                analisar: !!cards.analisar
                            });
                            
                            // TESTE 2: Tarefas IA - Bug de respostas incorretas
                            if (cards.tarefas) {
                                console.log('\\nüéØ TESTANDO TAREFAS IA...');
                                try {
                                    cards.tarefas.click();
                                    await new Promise(r => setTimeout(r, 3000));
                                    
                                    const modal = document.querySelector('.modal, #questionModal');
                                    if (modal) {
                                        console.log('‚úÖ Modal de pergunta aberto');
                                        
                                        const alternatives = modal.querySelectorAll('.option, input[type="radio"]');
                                        console.log('üìã Alternativas encontradas:', alternatives.length);
                                        
                                        if (alternatives.length > 0) {
                                            alternatives[0].click();
                                            await new Promise(r => setTimeout(r, 1000));
                                            
                                            const isSelected = alternatives[0].checked || alternatives[0].classList.contains('selected');
                                            if (!isSelected) {
                                                bugs.push('‚ùå BUG: Sele√ß√£o visual das alternativas n√£o funciona');
                                            } else {
                                                console.log('‚úÖ Sele√ß√£o visual funcionando');
                                            }
                                        }
                                        
                                        // Fechar modal
                                        const closeBtn = modal.querySelector('.close, .modal-close');
                                        if (closeBtn) closeBtn.click();
                                    } else {
                                        bugs.push('‚ùå BUG: Modal de Tarefas IA n√£o abre');
                                    }
                                } catch (error) {
                                    bugs.push('‚ùå ERRO Tarefas IA: ' + error.message);
                                }
                            }
                            
                            // TESTE 3: Mentor IA - Bug do prompt
                            if (cards.mentor) {
                                console.log('\\nüß† TESTANDO MENTOR IA...');
                                try {
                                    cards.mentor.click();
                                    await new Promise(r => setTimeout(r, 2000));
                                    
                                    const inputModal = document.querySelector('.input-modal, #inputModal');
                                    if (!inputModal) {
                                        bugs.push('‚ùå BUG: Mentor IA usando prompt() nativo - n√£o pode ser fechado');
                                    } else {
                                        const closeBtn = inputModal.querySelector('.close, .modal-close');
                                        if (!closeBtn) {
                                            bugs.push('‚ùå BUG: Modal Mentor IA sem bot√£o fechar');
                                        } else {
                                            console.log('‚úÖ Modal Mentor IA com bot√£o fechar');
                                        }
                                    }
                                } catch (error) {
                                    bugs.push('‚ùå ERRO Mentor IA: ' + error.message);
                                }
                            }
                            
                            // TESTE 4: Quiz IA - Bug de erro de conex√£o
                            if (cards.quiz) {
                                console.log('\\nüß† TESTANDO QUIZ IA...');
                                try {
                                    cards.quiz.click();
                                    await new Promise(r => setTimeout(r, 6000));
                                    
                                    const bodyText = document.body.textContent;
                                    if (bodyText.includes('N√£o foi poss√≠vel gerar o quiz')) {
                                        bugs.push('‚ùå BUG: Quiz IA retorna erro de conex√£o');
                                    } else {
                                        console.log('‚úÖ Quiz IA n√£o retornou erro');
                                    }
                                } catch (error) {
                                    bugs.push('‚ùå ERRO Quiz IA: ' + error.message);
                                }
                            }
                            
                            // TESTE 5: Analisar - Bug de erro de conex√£o
                            if (cards.analisar) {
                                console.log('\\nüîç TESTANDO ANALISAR RECURSOS...');
                                try {
                                    cards.analisar.click();
                                    await new Promise(r => setTimeout(r, 6000));
                                    
                                    const bodyText = document.body.textContent;
                                    if (bodyText.includes('N√£o foi poss√≠vel analisar o recurso')) {
                                        bugs.push('‚ùå BUG: Analisar Recursos retorna erro de conex√£o');
                                    } else {
                                        console.log('‚úÖ Analisar Recursos n√£o retornou erro');
                                    }
                                } catch (error) {
                                    bugs.push('‚ùå ERRO Analisar: ' + error.message);
                                }
                            }
                            
                            // RELAT√ìRIO FINAL
                            console.log('\\n' + '='.repeat(50));
                            console.log('üìä RELAT√ìRIO FINAL - BUGS ENCONTRADOS');
                            console.log('='.repeat(50));
                            
                            if (bugs.length === 0) {
                                console.log('üéâ NENHUM BUG ENCONTRADO! Sistema funcionando.');
                            } else {
                                console.log('‚ö†Ô∏è BUGS ENCONTRADOS:');
                                bugs.forEach(bug => console.log(bug));
                                console.log('\\nüìà TOTAL DE BUGS:', bugs.length);
                            }
                            
                            return bugs;
                        }
                        
                        // Executar teste
                        testBugsRapido().then(bugs => {
                            console.log('\\nüéØ TESTE CONCLU√çDO!');
                            window.testResults = bugs;
                        });
                    `;
                    
                    // Injetar e executar script
                    try {
                        prodWindow.eval(testScript);
                        console.log('‚úÖ Teste executado na p√°gina de produ√ß√£o');
                    } catch (error) {
                        console.log('‚ùå Erro ao executar teste:', error);
                    }
                } else {
                    console.log('‚ùå N√£o foi poss√≠vel abrir p√°gina de produ√ß√£o');
                }
            }, 8000);
        }, 1000);
    </script>
</body>
</html>
